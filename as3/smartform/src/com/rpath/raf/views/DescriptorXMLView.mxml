<?xml version="1.0" encoding="utf-8"?>

<!--
#
# Copyright (c) 2008-2011 rPath, Inc.
#
# All rights reserved
#
-->

<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009" 
         xmlns:s="library://ns.adobe.com/flex/spark" 
         xmlns:mx="library://ns.adobe.com/flex/mx"
         >
    
    <fx:Metadata>
        [Event(name="editDescriptorXML", type="mx.events.DynamicEvent")]
    </fx:Metadata>
    
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>
    
    <fx:Script>
    <![CDATA[
        import mx.events.DynamicEvent;
        import mx.events.FlexEvent;
        import com.rpath.raf.models.Descriptor;
        import com.rpath.xobj.XObjXMLDecoder;
        
        [Bindable]
        public var descriptorString:String;
        
        [Bindable]
        public function get descriptorXML():XML
        {
            return _metadata;
        }
        
        private var _metadata:XML;
        
        public function set descriptorXML(value:XML):void
        {
            _metadata = value;
            
            // pretty print a version for our descriptor XML display
            XML.prettyIndent = 2;
            XML.prettyPrinting = true;
            
            descriptorString = value.toXMLString();
        }

        protected function valueCommitHandler(event:FlexEvent):void
        {
            var evt:DynamicEvent = new DynamicEvent("editDescriptorXML", true, true);
            evt.xml = new XML(mdInput.text);
            dispatchEvent(evt);
        }
        
    ]]>
    </fx:Script>
    
    <mx:TextArea id="mdInput" width="100%" height="100%" text="{descriptorString}" 
                 valueCommit="valueCommitHandler(event)" />

</s:Group>
